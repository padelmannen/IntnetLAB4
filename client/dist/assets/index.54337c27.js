import{l as b,r as y,o as i,c,a as s,b as k,F as u,d as w,e as p,t as h,w as v,f as _,v as f,g as S,h as A,i as C}from"./vendor.d89baaf0.js";const T=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}};T();var m=(e,t)=>{const a=e.__vccOpts||e;for(const[l,o]of t)a[l]=o;return a};const L={name:"App",components:{},data:()=>({socket:b().connect()}),created(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/users/me").then(a=>a.json()).then(({authenticated:a})=>{e("setAuthenticated",a),t(a===!0?"/rooms":"/login")}).catch(console.error)},methods:{redirect(e){this.$router.push(e)}}},N={class:"navbar navbar-expand-md navbar-dark bg-dark"},O=s("button",{class:"navbar-toggler mx-2 mb-2",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[s("span",{class:"navbar-toggler-icon"})],-1),V={id:"navbarNav",class:"collapse navbar-collapse mx-2"},j={class:"navbar-nav"},R={class:"nav-item"},x={class:"nav-item"},q={class:"nav-item"},E={class:"nav-item"},P={class:"container-fluid py-4"};function U(e,t,a,l,o,n){const r=y("router-view");return i(),c(u,null,[s("nav",N,[O,s("div",V,[s("ul",j,[s("li",R,[s("a",{class:"nav-link",href:"#",onClick:t[0]||(t[0]=d=>n.redirect("/login"))},"Login")]),s("li",x,[s("a",{class:"nav-link",href:"#",onClick:t[1]||(t[1]=d=>n.redirect("/rooms"))},"Rooms")]),s("li",q,[s("a",{class:"nav-link",href:"#",onClick:t[2]||(t[2]=d=>n.redirect("/admin"))},"Admin")]),s("li",E,[s("a",{class:"nav-link",href:"#",onClick:t[3]||(t[3]=d=>n.redirect("/timeSlots"))},"TimeSlots")])])])]),s("section",P,[k(r)])],64)}var B=m(L,[["render",U]]),$=w({state:{authenticated:!1},getters:{isAuthenticated(e){return e.authenticated}},mutations:{setAuthenticated(e,t){e.authenticated=t}},actions:{},modules:{}});const D={name:"RoomsView",components:{},data:()=>({rooms:[]}),created(){fetch("/api/rooms").then(e=>e.json()).then(({rooms:e})=>{this.rooms=e}).catch(console.error)},methods:{redirect(e){this.$router.push(`/rooms/${e}`)}}},F={class:"row"},M=s("div",{class:"col"},null,-1),J={class:"col list-group"},K=["onClick"],H=s("div",{class:"col"},null,-1);function I(e,t,a,l,o,n){return i(),c("div",F,[M,s("div",J,[(i(!0),c(u,null,p(e.rooms,r=>(i(),c("button",{key:r.name,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:d=>n.redirect(r.name)},h(r.name),9,K))),128))]),H])}var W=m(D,[["render",I]]);const z={name:"RoomView",components:{},data(){return{name:this.$route.params.name,messages:[],message:""}},async created(){const e=await fetch(`/api/rooms/${this.name}/messages`),{messages:t}=await e.json();this.messages=t;const{socket:a}=this.$root;a.on("msg",l=>{this.messages=[...this.messages,l]})},methods:{send(){fetch(`/api/rooms/${this.name}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:this.message})}).catch(console.error),this.message=""}}},G={class:"row"},Q=s("div",{class:"col-3"},null,-1),X={class:"col-6 list-group"},Y=s("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"SEND",-1),Z=s("div",{class:"col-3"},null,-1);function ee(e,t,a,l,o,n){return i(),c("div",G,[Q,s("ul",X,[(i(!0),c(u,null,p(o.messages,(r,d)=>(i(),c("li",{key:d,type:"button",class:"list-group-item py-1"},h(r),1))),128)),s("form",{onSubmit:t[1]||(t[1]=v(r=>n.send(),["prevent"]))},[_(s("input",{id:"message","onUpdate:modelValue":t[0]||(t[0]=r=>o.message=r),type:"text",class:"form-control form-control-sm",placeholder:"message...",required:"",autofocus:""},null,512),[[f,o.message]]),Y],32)]),Z])}var te=m(z,[["render",ee]]);const se={name:"LoginView",components:{},data:()=>({username:"",password:""}),methods:{authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(a=>a.json()).then(({authenticated:a})=>{e("setAuthenticated",a),t(a===!0?"/rooms":"/login")}).catch(console.error)}}},oe={class:"row"},ne=s("div",{class:"col"},null,-1),re=s("label",{for:"username",class:"form-label h4"},"Anv\xE4ndarnamn",-1),ae=s("label",{for:"password",class:"form-label h4"},"L\xF6senord",-1),ie=s("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"OK",-1),ce=s("div",{class:"col"},null,-1);function le(e,t,a,l,o,n){return i(),c("div",oe,[ne,s("form",{class:"col",onSubmit:t[2]||(t[2]=v(r=>n.authenticate(),["prevent"]))},[re,_(s("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=r=>e.username=r),type:"text",class:"form-control",placeholder:"username...",required:"",autofocus:""},null,512),[[f,e.username]]),ae,_(s("input",{id:"password","onUpdate:modelValue":t[1]||(t[1]=r=>e.password=r),type:"password",class:"form-control",placeholder:"password...",required:"",autofocus:""},null,512),[[f,e.password]]),ie],32),ce])}var de=m(se,[["render",le]]);const me={name:"TimeSlots",components:{},data:()=>({timeSlots:[]}),created(){fetch("/api/timeSlots").then(e=>e.json()).then(({rooms:e})=>{this.timeSlots=timeSlots}).catch(console.error)},methods:{redirect(e){this.$router.push(`/timeSlots/${e}`)},bookTime(){console.log("bokar tid")}}},ue={class:"row"},pe=s("div",{class:"col"},null,-1),he={class:"col list-group"},_e=["onClick"],fe=s("div",{class:"col"},null,-1);function ve(e,t,a,l,o,n){return i(),c("div",ue,[pe,s("div",he,[(i(!0),c(u,null,p(e.timeSlots,r=>(i(),c("button",{key:r.id,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:d=>n.bookTime(r.id)},h(r.time),9,_e))),128))]),fe])}var $e=m(me,[["render",ve]]);const ge={name:"AdminView",components:{},data:()=>({timeSlots:[]}),created(){fetch("/api/admin").then(e=>e.json()).then(({rooms:e})=>{this.rooms=e}).catch(console.error)},methods:{redirect(e){this.$router.push(`/admin/${e}`)},changeTimeSlots(){console.log("admin timeslot")}}},be={class:"row"},ye=s("div",{class:"col"},null,-1),ke={class:"col list-group"},we=["onClick"],Se=s("div",{class:"col"},null,-1);function Ae(e,t,a,l,o,n){return i(),c("div",be,[ye,s("div",ke,[(i(!0),c(u,null,p(e.timeSlots,r=>(i(),c("button",{key:r.id,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:d=>n.changeTimeSlots(r.id)},h(e.room.name),9,we))),128))]),Se])}var Ce=m(ge,[["render",Ae]]);const Te=[{path:"/",redirect:"/rooms"},{path:"/rooms",component:W},{path:"/rooms/:name",component:te},{path:"/login",component:de},{path:"/timeSlots",component:$e},{path:"/admin",component:Ce}],g=S({history:A("/"),routes:Te});g.beforeEach((e,t,a)=>{$.state.authenticated||e.path==="/login"?a():(console.info("Unauthenticated user. Redirecting to login page."),a("/login"))});C(B).use($).use(g).mount("#app");
