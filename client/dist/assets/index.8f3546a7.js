import{l as T,r as g,o as a,c as l,a as o,b as S,F as u,d as A,e as _,t as h,w as $,f as p,v as f,g as b,h as v,i as j,j as N,k as O}from"./vendor.75495810.js";const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))d(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&d(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}};P();var m=(e,t)=>{const s=e.__vccOpts||e;for(const[d,i]of t)s[d]=i;return s};const V={name:"App",components:{},data:()=>({socket:T().connect()}),created(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/users/me").then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/timeslots":"/booking")}).catch(console.error)},methods:{redirect(e){this.$router.push(e)}}},W={class:"navbar navbar-expand-md navbar-dark bg-dark"},L=o("button",{class:"navbar-toggler mx-2 mb-2",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[o("span",{class:"navbar-toggler-icon"})],-1),B={id:"navbarNav",class:"collapse navbar-collapse mx-2"},R={class:"navbar-nav"},U={class:"nav-item"},q={class:"nav-item"},J={class:"container-fluid py-4"};function E(e,t,s,d,i,n){const r=g("router-view");return a(),l(u,null,[o("nav",W,[L,o("div",B,[o("ul",R,[o("li",U,[o("a",{class:"nav-link",href:"#",onClick:t[0]||(t[0]=c=>n.redirect("/booking"))},"Booking")]),o("li",q,[o("a",{class:"nav-link",href:"#",onClick:t[1]||(t[1]=c=>n.redirect("/admin"))},"Admin")])])])]),o("section",J,[S(r)])],64)}var F=m(V,[["render",E]]),y=A({state:{authenticated:!1},getters:{isAuthenticated(e){return e.authenticated}},mutations:{setAuthenticated(e,t){e.authenticated=t}},actions:{},modules:{}});const D={name:"RoomsView",components:{},data:()=>({rooms:[]}),created(){fetch("/api/rooms").then(e=>e.json()).then(({rooms:e})=>{this.rooms=e}).catch(console.error)},methods:{redirect(e){this.$router.push(`/rooms/${e}`)}}},M={class:"row"},x=o("div",{class:"col"},null,-1),H={class:"col list-group"},I=["onClick"],K=o("div",{class:"col"},null,-1);function z(e,t,s,d,i,n){return a(),l("div",M,[x,o("div",H,[(a(!0),l(u,null,_(e.rooms,r=>(a(),l("button",{key:r.name,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:c=>n.redirect(r.name)},h(r.name),9,I))),128))]),K])}var G=m(D,[["render",z]]);const Q={name:"RoomView",components:{},data(){return{name:this.$route.params.name,messages:[],message:""}},async created(){const e=await fetch(`/api/rooms/${this.name}/messages`),{messages:t}=await e.json();this.messages=t;const{socket:s}=this.$root;s.on("msg",d=>{this.messages=[...this.messages,d]})},methods:{send(){fetch(`/api/rooms/${this.name}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:this.message})}).catch(console.error),this.message=""}}},X={class:"row"},Y=o("div",{class:"col-3"},null,-1),Z={class:"col-6 list-group"},ee=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"SEND",-1),te=o("div",{class:"col-3"},null,-1);function oe(e,t,s,d,i,n){return a(),l("div",X,[Y,o("ul",Z,[(a(!0),l(u,null,_(i.messages,(r,c)=>(a(),l("li",{key:c,type:"button",class:"list-group-item py-1"},h(r),1))),128)),o("form",{onSubmit:t[1]||(t[1]=$(r=>n.send(),["prevent"]))},[p(o("input",{id:"message","onUpdate:modelValue":t[0]||(t[0]=r=>i.message=r),type:"text",class:"form-control form-control-sm",placeholder:"message...",required:"",autofocus:""},null,512),[[f,i.message]]),ee],32)]),te])}var se=m(Q,[["render",oe]]);const ne={name:"confirmBookingView",components:{},props:{time:String},data:()=>({username:"",open:!1}),methods:{book(){this.$emit("close")},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/admin":"/booking")}).catch(console.error)}}},ie={class:"row"},re=o("div",{class:"col"},null,-1),ae=o("label",{for:"username",class:"form-label h4"},"Fill in name and confirm:",-1),le=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"Confirm",-1),ce=o("div",{class:"col"},null,-1);function de(e,t,s,d,i,n){return a(),l("div",ie,[re,o("form",{class:"col",onSubmit:t[2]||(t[2]=$(r=>n.book(),["prevent"]))},[ae,o("p",null,"Time: "+h(s.time),1),p(o("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=r=>e.username=r),type:"text",class:"form-control",placeholder:"Name",required:"",autofocus:""},null,512),[[f,e.username]]),le,o("button",{class:"btn btn-dark mt-4 float-start",onClick:t[1]||(t[1]=r=>e.$emit("close"))},"Cancel ")],32),ce])}var k=m(ne,[["render",de]]);const me={name:"BookingView",components:{Confirm:k},data:()=>({username:"",timeslots:[],showConfirmWindow:!1,curTimePressed:""}),created(){fetch("/api/timeslots").then(e=>e.json()).then(({timeslots:e})=>{this.timeslots=e}).catch(console.error)},methods:{bookTime(e){console.log("time pressed"),this.curTimePressed=e,this.showConfirmWindow=!0},closeConfirmWindow(){this.showConfirmWindow=!1},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/timeslots":"/booking")}).catch(console.error)}}},ue={class:"row"},he=o("div",{class:"col"},null,-1),pe={class:"col list-group"},fe=o("label",{for:"timetable",class:"form-label h4"},"Available times:",-1),_e=["onClick"],ge=o("div",{class:"col"},null,-1),$e={class:"row"},be=o("div",{class:"col"},null,-1),ve=o("div",{class:"col"},null,-1);function ye(e,t,s,d,i,n){const r=g("Confirm");return a(),l("div",ue,[he,o("div",pe,[fe,(a(!0),l(u,null,_(e.timeslots,c=>(a(),l("button",{key:c.time,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:C=>n.bookTime(c.time)},h(c.time),9,_e))),128))]),ge,o("div",$e,[be,e.showConfirmWindow?(a(),b(r,{key:0,time:e.curTimePressed,onClose:t[0]||(t[0]=()=>n.closeConfirmWindow())},null,8,["time"])):v("",!0)]),ve])}var ke=m(me,[["render",ye]]);const we={name:"adminLoginView",components:{},data:()=>({username:""}),methods:{authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/admin":"/booking")}).catch(console.error)}}},Ce={class:"row"},Te=o("div",{class:"col"},null,-1),Se=o("label",{for:"admin",class:"form-label h4"},"Admin login:",-1),Ae=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"Login",-1),je=o("div",{class:"col"},null,-1);function Ne(e,t,s,d,i,n){return a(),l("div",Ce,[Te,o("form",{class:"col",onSubmit:t[2]||(t[2]=$(r=>n.authenticate(),["prevent"]))},[Se,p(o("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=r=>e.username=r),type:"text",class:"form-control",placeholder:"Username",required:"",autofocus:""},null,512),[[f,e.username]]),p(o("input",{id:"password","onUpdate:modelValue":t[1]||(t[1]=r=>e.password=r),type:"text",class:"form-control",placeholder:"Password",required:"",autofocus:""},null,512),[[f,e.password]]),Ae],32),je])}var Oe=m(we,[["render",Ne]]);const Pe={name:"AdminView",components:{},data:()=>({username:"",timeslots:[],showConfigWindow:!1,curTimePressed:""}),created(){fetch("/api/timeslots").then(e=>e.json()).then(({timeslots:e})=>{this.timeslots=e}).catch(console.error)},methods:{configTimeSlot(e){console.log("time pressed"),this.curTimePressed=e,this.showConfigWindow=!0},logout(){alert("Tried to logout!")},closeConfigWindow(){this.$emit("close")},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/timeslots":"/booking")}).catch(console.error)}}},Ve={class:"row"},We=o("div",{class:"col"},null,-1),Le={class:"col list-group"},Be=o("label",{for:"timetable",class:"form-label h4"},"This is the admin page!",-1),Re=["onClick"],Ue=o("div",{class:"col"},null,-1),qe={class:"row"},Je=o("div",{class:"col"},null,-1),Ee=o("div",{class:"col"},null,-1);function Fe(e,t,s,d,i,n){const r=g("Confirm");return a(),l("div",Ve,[We,o("div",Le,[Be,(a(!0),l(u,null,_(e.timeslots,c=>(a(),l("button",{key:c.time,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:C=>n.configTimeSlot(c.time)},h(c.time),9,Re))),128)),o("button",{type:"button",class:"btn btn-dark mt-4 float-end",onClick:t[0]||(t[0]=c=>n.logout())}," Add Time Slot "),o("button",{type:"button",class:"btn btn-dark mt-4 float-end",onClick:t[1]||(t[1]=c=>n.logout())}," Logout ")]),Ue,o("div",qe,[Je,e.showConfigWindow?(a(),b(r,{key:0,time:e.curTimePressed,onClose:t[2]||(t[2]=()=>n.closeConfigWindow())},null,8,["time"])):v("",!0)]),Ee])}var De=m(Pe,[["render",Fe]]);const Me=[{path:"/",redirect:"/rooms"},{path:"/rooms",component:G},{path:"/rooms/:name",component:se},{path:"/booking",component:ke},{path:"/adminlogin",component:Oe},{path:"/admin",component:De},{path:"/confirm",component:k}],w=j({history:N("/"),routes:Me});w.beforeEach((e,t,s)=>{y.state.authenticated||e.path==="/booking"||e.path==="/adminlogin"||e.path==="/confirm"?s():e.path==="/admin"?s("/adminlogin"):(console.info("Unauthenticated user. Redirecting to booking page."),s("/booking"))});O(F).use(y).use(w).mount("#app");
