import{l as S,r as p,o as a,c as l,a as o,b as k,F as g,d as A,e as b,t as u,w as $,f,v as _,g as v,h as w,V as W,i as O,j as V,k as j}from"./vendor.7a499c27.js";const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}};P();var m=(e,t)=>{const s=e.__vccOpts||e;for(const[d,r]of t)s[d]=r;return s};const N={name:"App",components:{},data:()=>({socket:S().connect()}),created(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/users/me").then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/timeslots":"/booking")}).catch(console.error)},methods:{redirect(e){this.$router.push(e)}}},L={class:"navbar navbar-expand-md navbar-dark bg-dark"},B=o("button",{class:"navbar-toggler mx-2 mb-2",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[o("span",{class:"navbar-toggler-icon"})],-1),J={id:"navbarNav",class:"collapse navbar-collapse mx-2"},U={class:"navbar-nav"},q={class:"nav-item"},R={class:"nav-item"},F={class:"container-fluid py-4"};function E(e,t,s,d,r,n){const i=p("router-view");return a(),l(g,null,[o("nav",L,[B,o("div",J,[o("ul",U,[o("li",q,[o("a",{class:"nav-link",href:"#",onClick:t[0]||(t[0]=c=>n.redirect("/booking"))},"Booking")]),o("li",R,[o("a",{class:"nav-link",href:"#",onClick:t[1]||(t[1]=c=>n.redirect("/admin"))},"Admin")])])])]),o("section",F,[k(i)])],64)}var M=m(N,[["render",E]]),y=A({state:{authenticated:!1},getters:{isAuthenticated(e){return e.authenticated}},mutations:{setAuthenticated(e,t){e.authenticated=t}},actions:{},modules:{}});const D={name:"RoomsView",components:{},data:()=>({rooms:[]}),created(){fetch("/api/rooms").then(e=>e.json()).then(({rooms:e})=>{this.rooms=e}).catch(console.error)},methods:{redirect(e){this.$router.push(`/rooms/${e}`)}}},H={class:"row"},I=o("div",{class:"col"},null,-1),K={class:"col list-group"},z=["onClick"],G=o("div",{class:"col"},null,-1);function Q(e,t,s,d,r,n){return a(),l("div",H,[I,o("div",K,[(a(!0),l(g,null,b(e.rooms,i=>(a(),l("button",{key:i.name,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:c=>n.redirect(i.name)},u(i.name),9,z))),128))]),G])}var X=m(D,[["render",Q]]);const Y={name:"RoomView",components:{},data(){return{name:this.$route.params.name,messages:[],message:""}},async created(){const e=await fetch(`/api/rooms/${this.name}/messages`),{messages:t}=await e.json();this.messages=t;const{socket:s}=this.$root;s.on("msg",d=>{this.messages=[...this.messages,d]})},methods:{send(){fetch(`/api/rooms/${this.name}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:this.message})}).catch(console.error),this.message=""}}},Z={class:"row"},x=o("div",{class:"col-3"},null,-1),ee={class:"col-6 list-group"},te=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"SEND",-1),oe=o("div",{class:"col-3"},null,-1);function se(e,t,s,d,r,n){return a(),l("div",Z,[x,o("ul",ee,[(a(!0),l(g,null,b(r.messages,(i,c)=>(a(),l("li",{key:c,type:"button",class:"list-group-item py-1"},u(i),1))),128)),o("form",{onSubmit:t[1]||(t[1]=$(i=>n.send(),["prevent"]))},[f(o("input",{id:"message","onUpdate:modelValue":t[0]||(t[0]=i=>r.message=i),type:"text",class:"form-control form-control-sm",placeholder:"message...",required:"",autofocus:""},null,512),[[_,r.message]]),te],32)]),oe])}var ne=m(Y,[["render",se]]);const ie={name:"confirmBookingView",components:{},props:{time:String},data:()=>({username:"",open:!1,duration:20*1e3,elapsed:0,windowOpen:!0}),created(){this.elapsed=0,console.log("created and elapsed reset!");let e=performance.now();const t=()=>{const s=performance.now();this.elapsed+=Math.min(s-e,this.duration-this.elapsed),console.log(this.elapsed),e=s,this.duration!==this.elapsed&&this.windowOpen?this.handle=requestAnimationFrame(t):this.closeWindow()};t()},methods:{book(){this.closeWindow()},closeWindow(){this.windowOpen=!1,this.$emit("close")},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/admin":"/booking")}).catch(console.error)}}},re={class:"row"},ae=o("div",{class:"col"},null,-1),le=o("label",{for:"username",class:"form-label h4"},"Fill in name and confirm:",-1),ce=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"Confirm",-1),de=o("div",{class:"col"},null,-1);function me(e,t,s,d,r,n){return a(),l("div",re,[ae,o("form",{class:"col",onSubmit:t[2]||(t[2]=$(i=>n.book(),["prevent"]))},[le,o("p",null,"Time Slot: "+u(s.time),1),o("div",null," Time left to confirm: "+u(((e.duration-e.elapsed)/1e3).toFixed(0))+" seconds ",1),f(o("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=i=>e.username=i),type:"text",class:"form-control",placeholder:"Name",required:"",autofocus:""},null,512),[[_,e.username]]),ce,o("button",{class:"btn btn-dark mt-4 float-start",onClick:t[1]||(t[1]=i=>n.closeWindow())},"Cancel ")],32),de])}var C=m(ie,[["render",me]]);const ue={name:"BookingView",components:{Confirm:C},data:()=>({username:"",timeslots:[],showConfirmWindow:!1,curTimePressed:""}),created(){fetch("/api/timeslots").then(e=>e.json()).then(({timeslots:e})=>{this.timeslots=e}).catch(console.error)},methods:{bookTime(e){console.log("time pressed"),this.curTimePressed=e,this.closeConfirmWindow(),this.showConfirmWindow=!0},closeConfirmWindow(){this.showConfirmWindow=!1},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/timeslots":"/booking")}).catch(console.error)}}},he={class:"row"},pe=o("div",{class:"col"},null,-1),fe={class:"col list-group"},_e=o("label",{for:"timetable",class:"form-label h4"},"Available times:",-1),ge=["onClick"],$e=o("div",{class:"col"},null,-1),be={class:"row"},ve=o("div",{class:"col"},null,-1),we=o("div",{class:"col"},null,-1);function ke(e,t,s,d,r,n){const i=p("Confirm");return a(),l("div",he,[pe,o("div",fe,[_e,(a(!0),l(g,null,b(e.timeslots,c=>(a(),l("button",{key:c.time,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:h=>n.bookTime(c.time)},u(c.time),9,ge))),128))]),$e,o("div",be,[ve,e.showConfirmWindow?(a(),v(i,{key:0,time:e.curTimePressed,onClose:t[0]||(t[0]=()=>n.closeConfirmWindow())},null,8,["time"])):w("",!0)]),we])}var ye=m(ue,[["render",ke]]);const Ce={name:"adminLoginView",components:{},data:()=>({username:""}),methods:{authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/admin":"/booking")}).catch(console.error)}}},Te={class:"row"},Se=o("div",{class:"col"},null,-1),Ae=o("label",{for:"admin",class:"form-label h4"},"Admin login:",-1),We=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"Login",-1),Oe=o("div",{class:"col"},null,-1);function Ve(e,t,s,d,r,n){return a(),l("div",Te,[Se,o("form",{class:"col",onSubmit:t[2]||(t[2]=$(i=>n.authenticate(),["prevent"]))},[Ae,f(o("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=i=>e.username=i),type:"text",class:"form-control",placeholder:"Username",required:"",autofocus:""},null,512),[[_,e.username]]),f(o("input",{id:"password","onUpdate:modelValue":t[1]||(t[1]=i=>e.password=i),type:"text",class:"form-control",placeholder:"Password",required:"",autofocus:""},null,512),[[_,e.password]]),We],32),Oe])}var je=m(Ce,[["render",Ve]]);const Pe={name:"configTimeSlotView",components:{},props:{time:String},data:()=>({username:"",open:!1}),methods:{removeTimeSlot(){this.$emit("close")},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/admin":"/booking")}).catch(console.error)}}},Ne={class:"row"},Le=o("div",{class:"col"},null,-1),Be=o("label",{for:"username",class:"form-label h4"},"Configure Time Slot",-1),Je=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"Remove",-1),Ue=o("div",{class:"col"},null,-1);function qe(e,t,s,d,r,n){return a(),l("div",Ne,[Le,o("form",{class:"col",onSubmit:t[1]||(t[1]=$(i=>n.removeTimeSlot(),["prevent"]))},[Be,o("p",null,"Time: "+u(s.time),1),Je,o("button",{class:"btn btn-dark mt-4 float-start",onClick:t[0]||(t[0]=i=>e.$emit("close"))},"Cancel ")],32),Ue])}var Re=m(Pe,[["render",qe]]);const Fe={name:"configTimeSlotView",components:{VueTimepicker:W},data:()=>({username:"",open:!1,timePicked:""}),methods:{removeTimeSlot(){this.$emit("close")},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/admin":"/booking")}).catch(console.error)}}},Ee={class:"row"},Me=o("div",{class:"col"},null,-1),De=o("label",{for:"username",class:"form-label h4"},"Add Time Slot",-1),He=o("button",{type:"submit",class:"btn btn-dark mt-4 float-end"},"Add",-1),Ie=o("div",{class:"col"},null,-1);function Ke(e,t,s,d,r,n){const i=p("VueTimepicker");return a(),l("div",Ee,[Me,o("form",{class:"col",onSubmit:t[3]||(t[3]=$(c=>n.removeTimeSlot(),["prevent"]))},[De,k(i,{id:"timepicker",modelValue:e.timePicked,"onUpdate:modelValue":t[0]||(t[0]=c=>e.timePicked=c)},null,8,["modelValue"]),f(o("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=c=>e.username=c),type:"text",class:"form-control",placeholder:"Time",required:"",autofocus:""},null,512),[[_,e.username]]),He,o("button",{class:"btn btn-dark mt-4 float-start",onClick:t[2]||(t[2]=c=>e.$emit("close"))}," Cancel ")],32),Ie])}var ze=m(Fe,[["render",Ke]]);const Ge={name:"AdminView",components:{Configure:Re,Add:ze},data:()=>({username:"",timeslots:[],showConfigWindow:!1,showAddWindow:!1,curTimePressed:""}),created(){fetch("/api/timeslots").then(e=>e.json()).then(({timeslots:e})=>{this.timeslots=e}).catch(console.error)},methods:{logout(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",!1),t("/booking")}).catch(console.error)},configTimeSlot(e){console.log("time pressed"),this.closeAddWindow(),this.curTimePressed=e,this.showConfigWindow=!0},closeConfigWindow(){console.log("close configure window"),this.showConfigWindow=!1},addTimeSlot(){console.log("add time slot"),this.closeConfigWindow(),this.showAddWindow=!0},closeAddWindow(){console.log("close add window"),this.showAddWindow=!1},authenticate(){const{commit:e}=this.$store,{push:t}=this.$router;fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username})}).then(s=>s.json()).then(({authenticated:s})=>{e("setAuthenticated",s),t(s===!0?"/timeslots":"/booking")}).catch(console.error)}}},Qe={class:"row"},Xe=o("div",{class:"col"},null,-1),Ye={class:"col list-group"},Ze=o("label",{for:"timetable",class:"form-label h4"},"This is the admin page!",-1),xe=["onClick"],et=o("div",{class:"col"},null,-1),tt={class:"row"},ot=o("div",{class:"col"},null,-1),st=o("div",{class:"col"},null,-1);function nt(e,t,s,d,r,n){const i=p("Configure"),c=p("Add");return a(),l("div",Qe,[Xe,o("div",Ye,[Ze,(a(!0),l(g,null,b(e.timeslots,h=>(a(),l("button",{key:h.time,type:"button",class:"list-group-item list-group-item-action my-2 py-2",onClick:at=>n.configTimeSlot(h.time)},u(h.time),9,xe))),128)),o("button",{type:"button",class:"btn btn-dark mt-4 float-end",onClick:t[0]||(t[0]=h=>n.addTimeSlot())}," Add Time Slot "),o("button",{type:"button",class:"btn btn-dark mt-4 float-end",onClick:t[1]||(t[1]=h=>n.logout())}," Logout ")]),et,o("div",tt,[ot,e.showConfigWindow?(a(),v(i,{key:0,time:e.curTimePressed,onClose:t[2]||(t[2]=()=>n.closeConfigWindow())},null,8,["time"])):w("",!0),e.showAddWindow?(a(),v(c,{key:1,onClose:t[3]||(t[3]=()=>n.closeAddWindow())})):w("",!0)]),st])}var it=m(Ge,[["render",nt]]);const rt=[{path:"/",redirect:"/rooms"},{path:"/rooms",component:X},{path:"/rooms/:name",component:ne},{path:"/booking",component:ye},{path:"/adminlogin",component:je},{path:"/admin",component:it},{path:"/confirm",component:C}],T=O({history:V("/"),routes:rt});T.beforeEach((e,t,s)=>{y.state.authenticated||e.path==="/booking"||e.path==="/adminlogin"||e.path==="/confirm"?s():e.path==="/admin"?s("/adminlogin"):(console.info("Unauthenticated user. Redirecting to booking page."),s("/booking"))});j(M).use(y).use(T).mount("#app");
